CREATE TABLE SAMSON_BILLING_ACCOUNT 
  ( CUSTOMER_ID INT,
    BIRTH_DATE DATE,
    ACCOUNT_TYPE CHAR(1),
    BAN_STATUS CHAR(1),
    STATUS_LAST_DATE DATE,    
    ACCOUNT_SUB_TYPE CHAR(1),
    BILL_CYCLE INT,
    CYCLE_CLOSE_DAY INT );

CREATE INDEX IDX_BAN ON SAMSON_BILLING_ACCOUNT(BAN);

INSERT INTO SAMSON_BILLING_ACCOUNT (BAN, BIRTH_DATE, ACCOUNT_TYPE, BAN_STATUS, STATUS_LAST_DATE, ACCOUNT_SUB_TYPE, BILL_CYCLE, CYCLE_CLOSE_DAY) VALUES ( 29784,  '2000-02-18',  'B',  'D',  '2016-02-23',  'L',  44183,  261);

SELECT * FROM SAMSON_BILLING_ACCOUNT;
 
CREATE TABLE SAMSON_SUBSCRIBER
  ( CUSTOMER_ID INT,
    SUBSCRIBER_NO VARCHAR(20), 
    SUB_STATUS CHAR(1),
    SUB_STATUS_DATE DATE,
    NEXT_CTN VARCHAR(20),
    PRV_CTN VARCHAR(20),
    SUB_STATUS_LAST_ACT CHAR(3) );

INSERT INTO SAMSON_SUBSCRIBER (CUSTOMER_ID, SUBSCRIBER_NO, SUB_STATUS, SUB_STATUS_DATE, NEXT_CTN, PRV_CTN, SUB_STATUS_LAST_ACT)
 VALUES ( 29784,  '200223',  '4',  '1985-02-23',  'next200223', 'prv200223',  'abc');

SELECT * FROM SAMSON_SUBSCRIBER;

CREATE TABLE SAMSON_ADDRESS_NAME_LINK
  ( CUSTOMER_ID  Int,
    SUBSCRIBER_NO VARCHAR(20),
    LINK_TYPE CHAR(1),
    ADDRESS_ID INT,
    NAME_ID INT);

INSERT INTO SAMSON_ADDRESS_NAME_LINK(CUSTOMER_ID, SUBSCRIBER_NO, LINK_TYPE, ADDRESS_ID, NAME_ID) 
  VALUES ( 29784,  '200223', 'F', 10234, 521);

CREATE TABLE SAMSON_NAME_DATA
  ( NAME_ID INT,
    LAST_BUSINESS_NAME VARCHAR(60),
    FIRST_NAME VARCHAR(40),
    MIDDLE_INITIAL VARCHAR(32) );

INSERT INTO SAMSON_NAME_DATA( NAME_ID, LAST_BUSINESS_NAME, FIRST_NAME, MIDDLE_INITIAL) 
  VALUES ( 521, 'PONTE', 'PAULO', 'BELLUCCI');

CREATE TABLE SAMSON_ADDRESS_DATA
  ( ADDRESS_ID Int,
    ADR_ZIP CHAR(5),
    ADR_ZIP_4 CHAR(4) );

INSERT INTO SAMSON_ADDRESS_DATA(ADDRESS_ID, ADR_ZIP, ADR_ZIP_4) 
  VALUES ( 10234,  'ZIP', 'ZIP4');

CREATE TABLE  SAMSON_SERIAL_ITEM_INV_DATA 
  (
    CUSTOMER_ID Int,
    SUBSCRIBER_NO VARCHAR(20),
    SIM VARCHAR(20),
    IMSI VARCHAR(20) );

INSERT INTO SAMSON_SERIAL_ITEM_INV_DATA(CUSTOMER_ID, SUBSCRIBER_NO, SIM, IMSI) 
  VALUES ( 29784,  '200223', 'SIM', 'IMSI');


CREATE TABLE  SAMSON_PHYSICAL_DEVICE (
    CUSTOMER_ID Int,
    SUBSCRIBER_NO VARCHAR(20),
    UNIT_ESN   VARCHAR(20),
     );

INSERT INTO SAMSON_PHYSICAL_DEVICE(CUSTOMER_ID, SUBSCRIBER_NO, UNIT_ESN, EQU_TYPE) 
  VALUES ( 29784,  '200223', 'UNIT', 'E');

   select a.BAN, a.ACCOUNT_TYPE, a.BIRTH_DATE, a.BILL_CYCLE,
          b.SUBSCRIBER_NO, b.SUB_STATUS_LAST_ACT,
          d.FIRST_NAME, d.LAST_BUSINESS_NAME,
          f.ADR_ZIP,
          g.SIM, g.IMSI,
          h.UNIT_ESN 
   from SAMSON_BILLING_ACCOUNT a, SAMSON_SUBSCRIBER b, SAMSON_ADDRESS_NAME_LINK c,
        SAMSON_NAME_DATA d, SAMSON_ADDRESS_NAME_LINK e,  SAMSON_ADDRESS_DATA f,
        SAMSON_SERIAL_ITEM_INV_DATA g, SAMSON_PHYSICAL_DEVICE h 
   where a.BAN = 29784
     and a.BAN = b.CUSTOMER_ID 
     and b.SUB_STATUS != 'C' 
     and b.CUSTOMER_ID  = c.CUSTOMER_ID 
     and b.SUBSCRIBER_NO = c.SUBSCRIBER_NO
     and c.link_type = 'U' 
     and c.NAME_ID = d.NAME_ID 
     and b.CUSTOMER_ID  = e.CUSTOMER_ID 
     and b.SUBSCRIBER_NO = e.SUBSCRIBER_NO
     and e.LINK_TYPE = 'B'
     and e.ADDRESS_ID = f.ADDRESS_ID
     and b.CUSTOMER_ID  = g.CUSTOMER_ID 
     and b.SUBSCRIBER_NO = g.SUBSCRIBER_NO
     and b.CUSTOMER_ID  = h.CUSTOMER_ID 
     and b.SUBSCRIBER_NO = h.SUBSCRIBER_NO
 



  select a.BAN, a.ACCOUNT_TYPE, a.BIRTH_DATE, a.BILL_CYCLE,
          b.SUBSCRIBER_NO, b.SUB_STATUS_LAST_ACT,
          d.FIRST_NAME, d.LAST_BUSINESS_NAME,
          f.ADR_ZIP,
          g.SIM, g.IMSI,
          h.UNIT_ESN 
   from SAMSON_BILLING_ACCOUNT a, SAMSON_SUBSCRIBER b, 
        SAMSON_NAME_DATA d, SAMSON_ADDRESS_NAME_LINK e,
        SAMSON_ADDRESS_DATA f,
        SAMSON_SERIAL_ITEM_INV_DATA g, SAMSON_PHYSICAL_DEVICE h     
   where a.BAN = b.CUSTOMER_ID
     and b.CUSTOMER_ID = e.CUSTOMER_ID
     and b.SUBSCRIBER_NO = e.SUBSCRIBER_NO
     and e.ADDRESS_ID = f.ADDRESS_ID 
     and e.ADE_ID = f.NAME_ID
     and b.CUSTOMER_ID  = g.CUSTOMER_ID 
     and b.SUBSCRIBER_NO = g.SUBSCRIBER_NO
     and b.CUSTOMER_ID  = h.CUSTOMER_ID 
     and b.SUBSCRIBER_NO = h.SUBSCRIBER_NO
 CREATE JOIN INDEX IDX_SAMSON ON SAMSON_BILLING_ACCOUNT ( CUSTOMER_ID ) JOIN SAMSON_SUBSCRIBER ( SUBSCRIBER_NO) AND SAMSON_SUBSCRIBER
  JOIN SAMSON_ADDRESS_NAME_LINK  AND  SAMSON_ADDRESS_NAME_LINK JOIN SAMSON_NAME_DATA  AND  SAMSON_ADDRESS_NAME_LINK JOIN SAMSON_ADDRESS_DATA 
AND  SAMSON_SERIAL_ITEM_INV_DATA  JOIN  SAMSON_ADDRESS_NAME_LINK  AND  SAMSON_SERIAL_ITEM_INV_DATA JOIN SAMSON_PHYSICAL_DEVICE ;

